<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Oslo vs MÃ¡laga â€” Is the Move Worth It?</title>
  <meta name="description" content="Daily weather battle: Oslo, Norway vs MÃ¡laga, Spain. Real-time comparison to settle the question once and for all.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœˆï¸</text></svg>">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:      #0e1117;
      --bg2:     #161b24;
      --bg3:     #1e2535;
      --border:  rgba(255,255,255,0.07);
      --text:    #f0f2f5;
      --muted:   #7a8ba0;
      --oslo:    #4da6ff;
      --spain:   #ff7c3e;
      --green:   #22c55e;
      --red:     #ef4444;
      --gold:    #fbbf24;
    }

    body {
      font-family: -apple-system, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    /* â”€â”€ HEADER â”€â”€ */
    header {
      text-align: center;
      padding: 2.5rem 1rem 1.5rem;
      border-bottom: 1px solid var(--border);
    }
    header h1 {
      font-size: clamp(1.6rem, 5vw, 2.4rem);
      font-weight: 800;
      letter-spacing: -0.03em;
      line-height: 1.1;
    }
    .flags { font-size: clamp(1.8rem, 5vw, 2.6rem); display: block; margin-bottom: .4rem; }
    header p { color: var(--muted); font-size: .9rem; margin-top: .5rem; }

    /* â”€â”€ COUNTDOWN â”€â”€ */
    .countdown {
      display: inline-flex;
      gap: 1rem;
      margin-top: 1.2rem;
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: .75rem 1.5rem;
      flex-wrap: wrap;
      justify-content: center;
    }
    .cd-unit { text-align: center; }
    .cd-num  { font-size: 1.6rem; font-weight: 800; color: var(--spain); line-height: 1; }
    .cd-lbl  { font-size: .65rem; color: var(--muted); text-transform: uppercase; letter-spacing: .08em; margin-top: 2px; }

    /* â”€â”€ MAIN GRID â”€â”€ */
    .vs-grid {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 0;
      max-width: 900px;
      margin: 2rem auto;
      padding: 0 1rem;
      align-items: start;
    }
    @media (max-width: 600px) {
      .vs-grid { grid-template-columns: 1fr; gap: 0; }
      .vs-divider { display: none; }
    }

    .city-card {
      background: var(--bg2);
      border: 1px solid var(--border);
      padding: 1.5rem;
    }
    .city-card.oslo  { border-radius: 16px 0 0 16px; border-right: none; }
    .city-card.spain { border-radius: 0 16px 16px 0; border-left: none; }
    @media (max-width: 600px) {
      .city-card.oslo  { border-radius: 16px 16px 0 0; border-right: 1px solid var(--border); border-bottom: none; }
      .city-card.spain { border-radius: 0 0 16px 16px; border-left: 1px solid var(--border); border-top: none; }
    }

    .city-flag { font-size: 2rem; }
    .city-name {
      font-size: 1.3rem;
      font-weight: 800;
      margin: .3rem 0 .1rem;
      letter-spacing: -.02em;
    }
    .city-name.oslo  { color: var(--oslo); }
    .city-name.spain { color: var(--spain); }
    .city-country { font-size: .8rem; color: var(--muted); }

    .big-temp {
      font-size: clamp(3.5rem, 10vw, 5rem);
      font-weight: 900;
      line-height: 1;
      margin: 1rem 0 .25rem;
      letter-spacing: -.04em;
    }
    .oslo  .big-temp { color: var(--oslo); }
    .spain .big-temp { color: var(--spain); }

    .feels-like { font-size: .82rem; color: var(--muted); margin-bottom: .8rem; }

    .weather-desc {
      font-size: 1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: .4rem;
    }
    .weather-emoji { font-size: 1.4rem; }

    .city-stats {
      margin-top: 1rem;
      display: flex;
      flex-direction: column;
      gap: .45rem;
    }
    .stat-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: .82rem;
      padding: .3rem 0;
      border-bottom: 1px solid var(--border);
    }
    .stat-row:last-child { border-bottom: none; }
    .stat-label { color: var(--muted); }
    .stat-value { font-weight: 600; }

    /* â”€â”€ VS DIVIDER â”€â”€ */
    .vs-divider {
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--bg2);
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
      width: 48px;
      align-self: stretch;
    }
    .vs-badge {
      background: var(--bg3);
      border: 2px solid var(--border);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: .75rem;
      font-weight: 800;
      color: var(--muted);
    }

    /* â”€â”€ COMPARISON TABLE â”€â”€ */
    .comparison {
      max-width: 900px;
      margin: 0 auto 2rem;
      padding: 0 1rem;
    }
    .comparison h2 {
      font-size: .75rem;
      text-transform: uppercase;
      letter-spacing: .1em;
      color: var(--muted);
      margin-bottom: .75rem;
    }
    .comp-row {
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      align-items: center;
      gap: .5rem;
      padding: .65rem .75rem;
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 10px;
      margin-bottom: .4rem;
    }
    .comp-oslo  { font-weight: 700; font-size: .95rem; }
    .comp-spain { font-weight: 700; font-size: .95rem; text-align: right; }
    .comp-label { text-align: center; font-size: .75rem; color: var(--muted); }
    .comp-oslo.winner  { color: var(--oslo); }
    .comp-spain.winner { color: var(--spain); }

    .winner-badge {
      display: inline-block;
      font-size: .6rem;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: .06em;
      padding: 2px 6px;
      border-radius: 4px;
      vertical-align: middle;
      margin-left: 4px;
    }
    .wb-oslo  { background: rgba(77,166,255,.15); color: var(--oslo); }
    .wb-spain { background: rgba(255,124,62,.15); color: var(--spain); }

    /* â”€â”€ VERDICT â”€â”€ */
    .verdict {
      max-width: 900px;
      margin: 0 auto 2rem;
      padding: 0 1rem;
    }
    .verdict-card {
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 1.5rem;
      text-align: center;
    }
    .verdict-emoji { font-size: 2.5rem; margin-bottom: .5rem; }
    .verdict-title {
      font-size: 1.3rem;
      font-weight: 800;
      letter-spacing: -.02em;
    }
    .verdict-sub { font-size: .85rem; color: var(--muted); margin-top: .4rem; }
    .score-bar {
      display: flex;
      justify-content: center;
      gap: .4rem;
      margin-top: 1rem;
    }
    .score-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--bg3);
      border: 2px solid var(--border);
    }
    .score-dot.oslo  { background: var(--oslo); border-color: var(--oslo); }
    .score-dot.spain { background: var(--spain); border-color: var(--spain); }

    /* â”€â”€ FOOTER â”€â”€ */
    footer {
      text-align: center;
      padding: 1.5rem 1rem 2.5rem;
      font-size: .75rem;
      color: var(--muted);
      border-top: 1px solid var(--border);
    }
    footer a { color: var(--muted); }

    .loading-msg {
      text-align: center;
      padding: 3rem;
      color: var(--muted);
      font-size: .9rem;
    }
    .error-msg { color: var(--red); }
  </style>
</head>
<body>

<header>
  <span class="flags">ğŸ‡³ğŸ‡´ âœˆï¸ ğŸ‡ªğŸ‡¸</span>
  <h1>Oslo vs MÃ¡laga</h1>
  <p>Is the move worth it? Let the weather decide.</p>
  <div class="countdown" id="countdown">
    <div class="cd-unit"><div class="cd-num" id="cd-days">â€¦</div><div class="cd-lbl">days</div></div>
    <div class="cd-unit"><div class="cd-num" id="cd-hours">â€¦</div><div class="cd-lbl">hours</div></div>
    <div class="cd-unit"><div class="cd-num" id="cd-mins">â€¦</div><div class="cd-lbl">minutes</div></div>
    <div class="cd-unit" style="border-left:1px solid var(--border);padding-left:1rem"><div class="cd-num" style="font-size:1rem;color:var(--muted)">until the move</div></div>
  </div>
</header>

<div id="main-content">
  <div class="loading-msg">Fetching weatherâ€¦</div>
</div>

<footer>
  Weather via <a href="https://open-meteo.com" target="_blank">Open-Meteo</a> Â· 
  Updates every 15 min Â·
  <a href="https://github.com/PiE-Derby/oslo-vs-spain" target="_blank">source</a> Â·
  <span id="updated-time"></span>
</footer>

<script>
const MOVE_DATE = new Date('2026-08-01T08:00:00+02:00');

const WMO = {
  0:'â˜€ï¸ Clear',1:'ğŸŒ¤ Mainly clear',2:'â›… Partly cloudy',3:'â˜ï¸ Overcast',
  45:'ğŸŒ« Foggy',48:'ğŸŒ« Icy fog',
  51:'ğŸŒ¦ Light drizzle',53:'ğŸŒ¦ Drizzle',55:'ğŸŒ§ Heavy drizzle',
  61:'ğŸŒ§ Light rain',63:'ğŸŒ§ Rain',65:'ğŸŒ§ Heavy rain',
  71:'ğŸŒ¨ Light snow',73:'ğŸŒ¨ Snow',75:'â„ï¸ Heavy snow',
  80:'ğŸŒ¦ Showers',81:'ğŸŒ§ Showers',82:'â›ˆ Heavy showers',
  95:'â›ˆ Thunderstorm',96:'â›ˆ Hail',99:'â›ˆ Hail storm',
};

function wmo(code) { return WMO[code] ?? 'ğŸŒ¡ Unknown'; }
function emoji(code) { return wmo(code).split(' ')[0]; }
function desc(code)  { return wmo(code).split(' ').slice(1).join(' '); }

function daylight(sunrise, sunset) {
  const s = new Date(sunrise), e = new Date(sunset);
  const mins = Math.round((e - s) / 60000);
  return `${Math.floor(mins/60)}h ${mins%60}m`;
}

function daylightMins(sunrise, sunset) {
  return Math.round((new Date(sunset) - new Date(sunrise)) / 60000);
}

function updateCountdown() {
  const now = new Date();
  const diff = MOVE_DATE - now;
  if (diff <= 0) {
    document.getElementById('cd-days').textContent = 'ğŸ‰';
    document.getElementById('cd-hours').textContent = '';
    document.getElementById('cd-mins').textContent = '';
    return;
  }
  const days  = Math.floor(diff / 86400000);
  const hours = Math.floor((diff % 86400000) / 3600000);
  const mins  = Math.floor((diff % 3600000) / 60000);
  document.getElementById('cd-days').textContent  = days;
  document.getElementById('cd-hours').textContent = hours;
  document.getElementById('cd-mins').textContent  = mins;
}

function scoreColor(wins, total) {
  const pct = wins / total;
  if (pct >= 0.8) return 'var(--green)';
  if (pct >= 0.5) return 'var(--gold)';
  return 'var(--red)';
}

function render(oslo, spain) {
  const oC = oslo.current, oD = oslo.daily;
  const sC = spain.current, sD = spain.daily;

  // Comparison metrics: higher is better unless noted
  const metrics = [
    {
      label: 'ğŸŒ¡ Temperature',
      oVal: oC.temperature_2m, sVal: sC.temperature_2m,
      oFmt: v => `${v.toFixed(1)}Â°C`, sFmt: v => `${v.toFixed(1)}Â°C`,
      higher: true,
    },
    {
      label: 'ğŸŒ¡ Today high',
      oVal: oD.temperature_2m_max[0], sVal: sD.temperature_2m_max[0],
      oFmt: v => `${v.toFixed(1)}Â°C`, sFmt: v => `${v.toFixed(1)}Â°C`,
      higher: true,
    },
    {
      label: 'â˜€ï¸ Daylight',
      oVal: daylightMins(oD.sunrise[0], oD.sunset[0]),
      sVal: daylightMins(sD.sunrise[0], sD.sunset[0]),
      oFmt: () => daylight(oD.sunrise[0], oD.sunset[0]),
      sFmt: () => daylight(sD.sunrise[0], sD.sunset[0]),
      higher: true,
    },
    {
      label: 'ğŸŒ‚ Rain today',
      oVal: oD.precipitation_sum[0], sVal: sD.precipitation_sum[0],
      oFmt: v => `${v.toFixed(1)} mm`, sFmt: v => `${v.toFixed(1)} mm`,
      higher: false, // lower is better
    },
    {
      label: 'ğŸ’¨ Wind',
      oVal: oC.wind_speed_10m, sVal: sC.wind_speed_10m,
      oFmt: v => `${v.toFixed(1)} km/h`, sFmt: v => `${v.toFixed(1)} km/h`,
      higher: false,
    },
    {
      label: 'ğŸ”† UV index',
      oVal: oD.uv_index_max[0], sVal: sD.uv_index_max[0],
      oFmt: v => `${v.toFixed(1)}`, sFmt: v => `${v.toFixed(1)}`,
      higher: true,
    },
  ];

  let spainWins = 0;
  const rows = metrics.map(m => {
    const spainBetter = m.higher ? m.sVal > m.oVal : m.sVal < m.oVal;
    const tie = m.oVal === m.sVal;
    if (spainBetter && !tie) spainWins++;
    const oBadge = !spainBetter && !tie ? `<span class="winner-badge wb-oslo">WIN</span>` : '';
    const sBadge = spainBetter && !tie ? `<span class="winner-badge wb-spain">WIN</span>` : '';
    return `
    <div class="comp-row">
      <div class="comp-oslo ${!spainBetter && !tie ? 'winner' : ''}">${m.oFmt(m.oVal)}${oBadge}</div>
      <div class="comp-label">${m.label}</div>
      <div class="comp-spain ${spainBetter && !tie ? 'winner' : ''}">${sBadge}${m.sFmt(m.sVal)}</div>
    </div>`;
  }).join('');

  const osloWins = metrics.filter((m, i) => {
    const spainBetter = m.higher ? m.sVal > m.oVal : m.sVal < m.oVal;
    return !spainBetter && m.oVal !== m.sVal;
  }).length;

  const totalMetrics = metrics.length;
  const verdictEmoji = spainWins >= 5 ? 'ğŸŒ' : spainWins >= 4 ? 'ğŸŒ¤' : spainWins >= 3 ? 'âš–ï¸' : spainWins >= 2 ? 'ğŸ¥¶' : 'â„ï¸';
  const verdictTitle = spainWins >= 5 ? 'Spain dominates today.' :
    spainWins === 4 ? 'Spain takes it.' :
    spainWins === 3 ? 'A tie. Close call.' :
    spainWins === 2 ? 'Oslo edges it today.' :
    'Stay in Norway.';
  const verdictSub = `Spain wins ${spainWins}/${totalMetrics} metrics today.`;

  const dots = metrics.map((m, i) => {
    const spainBetter = m.higher ? m.sVal > m.oVal : m.sVal < m.oVal;
    const tie = m.oVal === m.sVal;
    if (tie) return `<div class="score-dot"></div>`;
    return `<div class="score-dot ${spainBetter ? 'spain' : 'oslo'}"></div>`;
  }).join('');

  document.getElementById('main-content').innerHTML = `
  <div class="vs-grid">
    <div class="city-card oslo">
      <div class="city-flag">ğŸ‡³ğŸ‡´</div>
      <div class="city-name oslo">Oslo</div>
      <div class="city-country">Norway Â· ${oD.sunrise[0].split('T')[0]}</div>
      <div class="big-temp">${oC.temperature_2m.toFixed(1)}Â°</div>
      <div class="feels-like">Feels like ${oC.apparent_temperature.toFixed(1)}Â°C</div>
      <div class="weather-desc">
        <span class="weather-emoji">${emoji(oC.weather_code)}</span>
        <span>${desc(oC.weather_code)}</span>
      </div>
      <div class="city-stats">
        <div class="stat-row"><span class="stat-label">High / Low</span><span class="stat-value">${oD.temperature_2m_max[0].toFixed(1)}Â° / ${oD.temperature_2m_min[0].toFixed(1)}Â°</span></div>
        <div class="stat-row"><span class="stat-label">Daylight</span><span class="stat-value">${daylight(oD.sunrise[0], oD.sunset[0])}</span></div>
        <div class="stat-row"><span class="stat-label">Sunrise</span><span class="stat-value">${oD.sunrise[0].split('T')[1]}</span></div>
        <div class="stat-row"><span class="stat-label">Sunset</span><span class="stat-value">${oD.sunset[0].split('T')[1]}</span></div>
        <div class="stat-row"><span class="stat-label">Wind</span><span class="stat-value">${oC.wind_speed_10m} km/h</span></div>
        <div class="stat-row"><span class="stat-label">UV index</span><span class="stat-value">${oD.uv_index_max[0].toFixed(1)}</span></div>
      </div>
    </div>

    <div class="vs-divider"><div class="vs-badge">VS</div></div>

    <div class="city-card spain">
      <div class="city-flag">ğŸ‡ªğŸ‡¸</div>
      <div class="city-name spain">MÃ¡laga</div>
      <div class="city-country">Spain Â· ${sD.sunrise[0].split('T')[0]}</div>
      <div class="big-temp">${sC.temperature_2m.toFixed(1)}Â°</div>
      <div class="feels-like">Feels like ${sC.apparent_temperature.toFixed(1)}Â°C</div>
      <div class="weather-desc">
        <span class="weather-emoji">${emoji(sC.weather_code)}</span>
        <span>${desc(sC.weather_code)}</span>
      </div>
      <div class="city-stats">
        <div class="stat-row"><span class="stat-label">High / Low</span><span class="stat-value">${sD.temperature_2m_max[0].toFixed(1)}Â° / ${sD.temperature_2m_min[0].toFixed(1)}Â°</span></div>
        <div class="stat-row"><span class="stat-label">Daylight</span><span class="stat-value">${daylight(sD.sunrise[0], sD.sunset[0])}</span></div>
        <div class="stat-row"><span class="stat-label">Sunrise</span><span class="stat-value">${sD.sunrise[0].split('T')[1]}</span></div>
        <div class="stat-row"><span class="stat-label">Sunset</span><span class="stat-value">${sD.sunset[0].split('T')[1]}</span></div>
        <div class="stat-row"><span class="stat-label">Wind</span><span class="stat-value">${sC.wind_speed_10m} km/h</span></div>
        <div class="stat-row"><span class="stat-label">UV index</span><span class="stat-value">${sD.uv_index_max[0].toFixed(1)}</span></div>
      </div>
    </div>
  </div>

  <div class="comparison">
    <h2>Head to head</h2>
    ${rows}
  </div>

  <div class="verdict">
    <div class="verdict-card">
      <div class="verdict-emoji">${verdictEmoji}</div>
      <div class="verdict-title">${verdictTitle}</div>
      <div class="verdict-sub">${verdictSub}</div>
      <div class="score-bar">${dots}</div>
      <div style="margin-top:.6rem;font-size:.72rem;color:var(--muted)">
        ğŸ‡³ğŸ‡´ Oslo <span style="margin:0 .3rem">Â·</span> âšª Tie <span style="margin:0 .3rem">Â·</span> ğŸ‡ªğŸ‡¸ MÃ¡laga
      </div>
    </div>
  </div>`;

  document.getElementById('updated-time').textContent =
    'Updated ' + new Date().toLocaleTimeString('en-GB', { hour:'2-digit', minute:'2-digit' });
}

async function load() {
  try {
    const base = 'https://api.open-meteo.com/v1/forecast';
    const params = 'current=temperature_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,uv_index&daily=sunrise,sunset,temperature_2m_max,temperature_2m_min,precipitation_sum,uv_index_max&forecast_days=1';

    const [osloRes, spainRes] = await Promise.all([
      fetch(`${base}?latitude=59.9139&longitude=10.7522&${params}&timezone=Europe/Oslo`),
      fetch(`${base}?latitude=36.7213&longitude=-4.4213&${params}&timezone=Europe/Madrid`),
    ]);

    const [oslo, spain] = await Promise.all([osloRes.json(), spainRes.json()]);
    render(oslo, spain);
  } catch(e) {
    document.getElementById('main-content').innerHTML =
      `<div class="loading-msg error-msg">Failed to load weather. Try again shortly.<br><small>${e.message}</small></div>`;
  }
}

updateCountdown();
setInterval(updateCountdown, 30000);
load();
setInterval(load, 15 * 60 * 1000);
</script>

</body>
</html>
