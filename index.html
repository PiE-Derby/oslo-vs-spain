<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Oslo vs Spain â€” Is the Move Worth It?</title>
  <meta name="description" content="Daily weather battle: Oslo vs Albir, MÃ¡laga and Gran Canaria. Real-time comparison to settle the question once and for all.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœˆï¸</text></svg>">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:     #0e1117;
      --bg2:    #161b24;
      --bg3:    #1e2535;
      --border: rgba(255,255,255,0.07);
      --text:   #f0f2f5;
      --muted:  #7a8ba0;
      --oslo:   #4da6ff;
      --spain:  #ff7c3e;
      --green:  #22c55e;
      --gold:   #fbbf24;
      --red:    #ef4444;
    }

    body {
      font-family: -apple-system, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    /* â”€â”€ HEADER â”€â”€ */
    header {
      text-align: center;
      padding: 2.5rem 1rem 1.5rem;
      border-bottom: 1px solid var(--border);
    }
    .flags { font-size: clamp(1.8rem, 5vw, 2.6rem); display: block; margin-bottom: .4rem; }
    header h1 {
      font-size: clamp(1.6rem, 5vw, 2.4rem);
      font-weight: 800;
      letter-spacing: -.03em;
    }
    header p { color: var(--muted); font-size: .88rem; margin-top: .4rem; }

    /* â”€â”€ COUNTDOWN â”€â”€ */
    .countdown {
      display: inline-flex;
      gap: 1rem;
      margin-top: 1.2rem;
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: .75rem 1.5rem;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
    }
    .cd-unit { text-align: center; }
    .cd-num  { font-size: 1.6rem; font-weight: 800; color: var(--spain); line-height: 1; }
    .cd-lbl  { font-size: .62rem; color: var(--muted); text-transform: uppercase; letter-spacing: .08em; margin-top: 2px; }
    .cd-sep  { color: var(--border); font-size: 1.4rem; font-weight: 300; }

    /* â”€â”€ DESTINATION TABS â”€â”€ */
    .dest-tabs {
      display: flex;
      justify-content: center;
      gap: .5rem;
      padding: 1.5rem 1rem .5rem;
      flex-wrap: wrap;
    }
    .dest-btn {
      background: var(--bg2);
      border: 1px solid var(--border);
      color: var(--muted);
      padding: .5rem 1.1rem;
      border-radius: 20px;
      font-size: .85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all .15s;
      font-family: inherit;
    }
    .dest-btn:hover { border-color: rgba(255,124,62,.4); color: var(--text); }
    .dest-btn.active {
      background: rgba(255,124,62,.12);
      border-color: rgba(255,124,62,.5);
      color: var(--spain);
    }

    /* â”€â”€ VS GRID â”€â”€ */
    .vs-grid {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      max-width: 900px;
      margin: 1.25rem auto 0;
      padding: 0 1rem;
      align-items: start;
    }
    @media (max-width: 600px) {
      .vs-grid { grid-template-columns: 1fr; }
      .vs-divider { display: none; }
    }

    .city-card {
      background: var(--bg2);
      border: 1px solid var(--border);
      padding: 1.5rem;
    }
    .city-card.oslo  { border-radius: 16px 0 0 16px; border-right: none; }
    .city-card.spain { border-radius: 0 16px 16px 0; border-left: none; }
    @media (max-width: 600px) {
      .city-card.oslo  { border-radius: 16px 16px 0 0; border-right: 1px solid var(--border); border-bottom: none; }
      .city-card.spain { border-radius: 0 0 16px 16px; border-left: 1px solid var(--border); }
    }

    .city-flag  { font-size: 2rem; }
    .city-name  { font-size: 1.3rem; font-weight: 800; margin: .3rem 0 .1rem; letter-spacing: -.02em; }
    .city-name.oslo  { color: var(--oslo); }
    .city-name.spain { color: var(--spain); }
    .city-sub   { font-size: .78rem; color: var(--muted); }

    .big-temp {
      font-size: clamp(3.5rem, 10vw, 5rem);
      font-weight: 900;
      line-height: 1;
      margin: 1rem 0 .2rem;
      letter-spacing: -.04em;
    }
    .oslo  .big-temp { color: var(--oslo); }
    .spain .big-temp { color: var(--spain); }

    .feels  { font-size: .82rem; color: var(--muted); margin-bottom: .7rem; }
    .w-desc { font-size: 1rem; font-weight: 600; display: flex; align-items: center; gap: .4rem; }
    .w-emoji { font-size: 1.4rem; }

    .stat-list { margin-top: 1rem; display: flex; flex-direction: column; gap: .4rem; }
    .stat-row  {
      display: flex; justify-content: space-between; align-items: center;
      font-size: .82rem; padding: .28rem 0;
      border-bottom: 1px solid var(--border);
    }
    .stat-row:last-child { border-bottom: none; }
    .stat-lbl  { color: var(--muted); }
    .stat-val  { font-weight: 600; }

    /* â”€â”€ DIVIDER â”€â”€ */
    .vs-divider {
      display: flex; align-items: center; justify-content: center;
      background: var(--bg2); border-top: 1px solid var(--border); border-bottom: 1px solid var(--border);
      width: 48px; align-self: stretch;
    }
    .vs-badge {
      background: var(--bg3); border: 2px solid var(--border); border-radius: 50%;
      width: 36px; height: 36px;
      display: flex; align-items: center; justify-content: center;
      font-size: .72rem; font-weight: 800; color: var(--muted);
    }

    /* â”€â”€ COMPARISON â”€â”€ */
    .comparison {
      max-width: 900px;
      margin: 1.25rem auto 0;
      padding: 0 1rem;
    }
    .comp-head {
      font-size: .72rem; text-transform: uppercase; letter-spacing: .1em;
      color: var(--muted); margin-bottom: .6rem;
    }
    .comp-row {
      display: grid;
      grid-template-columns: 1fr 2fr 1fr;
      align-items: center;
      gap: .5rem;
      padding: .6rem .75rem;
      background: var(--bg2);
      border: 1px solid var(--border);
      border-radius: 10px;
      margin-bottom: .35rem;
    }
    .co { font-weight: 700; font-size: .92rem; }
    .cs { font-weight: 700; font-size: .92rem; text-align: right; }
    .cl { text-align: center; font-size: .73rem; color: var(--muted); }
    .co.w { color: var(--oslo); }
    .cs.w { color: var(--spain); }
    .wb {
      display: inline-block; font-size: .58rem; font-weight: 800;
      text-transform: uppercase; letter-spacing: .06em;
      padding: 2px 5px; border-radius: 4px; vertical-align: middle; margin: 0 3px;
    }
    .wb-o { background: rgba(77,166,255,.15); color: var(--oslo); }
    .wb-s { background: rgba(255,124,62,.15); color: var(--spain); }

    /* â”€â”€ VERDICT â”€â”€ */
    .verdict {
      max-width: 900px;
      margin: 1.25rem auto 2rem;
      padding: 0 1rem;
    }
    .verdict-card {
      background: var(--bg2); border: 1px solid var(--border);
      border-radius: 16px; padding: 1.5rem; text-align: center;
    }
    .v-emoji { font-size: 2.2rem; margin-bottom: .4rem; }
    .v-title { font-size: 1.2rem; font-weight: 800; letter-spacing: -.02em; }
    .v-sub   { font-size: .83rem; color: var(--muted); margin-top: .35rem; }
    .score-bar { display: flex; justify-content: center; gap: .35rem; margin-top: .85rem; }
    .dot {
      width: 12px; height: 12px; border-radius: 50%;
      background: var(--bg3); border: 2px solid var(--border);
    }
    .dot.o { background: var(--oslo); border-color: var(--oslo); }
    .dot.s { background: var(--spain); border-color: var(--spain); }

    /* â”€â”€ FOOTER â”€â”€ */
    footer {
      text-align: center; padding: 1.5rem 1rem 2.5rem;
      font-size: .73rem; color: var(--muted);
      border-top: 1px solid var(--border);
    }
    footer a { color: var(--muted); }

    .spin { animation: spin 1s linear infinite; display: inline-block; }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body>

<header>
  <span class="flags">ğŸ‡³ğŸ‡´ âœˆï¸ ğŸ‡ªğŸ‡¸</span>
  <h1>Oslo vs Spain</h1>
  <p>Is the move worth it? Let the weather decide.</p>
  <div class="countdown">
    <div class="cd-unit"><div class="cd-num" id="cd-d">â€¦</div><div class="cd-lbl">days</div></div>
    <span class="cd-sep">:</span>
    <div class="cd-unit"><div class="cd-num" id="cd-h">â€¦</div><div class="cd-lbl">hours</div></div>
    <span class="cd-sep">:</span>
    <div class="cd-unit"><div class="cd-num" id="cd-m">â€¦</div><div class="cd-lbl">min</div></div>
    <div style="border-left:1px solid var(--border);padding-left:1rem">
      <div style="font-size:.82rem;color:var(--muted);font-weight:600">until the move âœˆï¸</div>
    </div>
  </div>
</header>

<div class="dest-tabs">
  <button class="dest-btn active" data-key="albir"    onclick="selectDest('albir')">   ğŸ– Albir</button>
  <button class="dest-btn"        data-key="malaga"   onclick="selectDest('malaga')">  â˜€ï¸ MÃ¡laga</button>
  <button class="dest-btn"        data-key="canaria"  onclick="selectDest('canaria')"> ğŸŒ´ Gran Canaria</button>
</div>

<div id="content" style="padding-bottom:2rem">
  <div style="text-align:center;padding:3rem;color:var(--muted)"><span class="spin">ğŸŒ</span> Loading weatherâ€¦</div>
</div>

<footer>
  Weather via <a href="https://open-meteo.com" target="_blank">Open-Meteo</a> Â·
  Auto-refreshes every 15 min Â·
  <a href="https://github.com/PiE-Derby/oslo-vs-spain" target="_blank">source</a> Â·
  <span id="upd"></span>
</footer>

<script>
const MOVE_DATE = new Date('2026-08-01T08:00:00+02:00');

const DESTS = {
  albir:   { name: 'Albir',        sub: 'Costa Blanca Â· Spain', flag: 'ğŸ‡ªğŸ‡¸', lat: 38.5678, lon: -0.0628, tz: 'Europe/Madrid' },
  malaga:  { name: 'MÃ¡laga',       sub: 'Costa del Sol Â· Spain', flag: 'ğŸ‡ªğŸ‡¸', lat: 36.7213, lon: -4.4213, tz: 'Europe/Madrid' },
  canaria: { name: 'Gran Canaria', sub: 'Canary Islands Â· Spain', flag: 'ğŸ‡®ğŸ‡¨', lat: 27.9202, lon: -15.5474, tz: 'Atlantic/Canary' },
};

const WMO = {
  0:'â˜€ï¸ Clear sky',1:'ğŸŒ¤ Mainly clear',2:'â›… Partly cloudy',3:'â˜ï¸ Overcast',
  45:'ğŸŒ« Foggy',48:'ğŸŒ« Icy fog',
  51:'ğŸŒ¦ Light drizzle',53:'ğŸŒ¦ Drizzle',55:'ğŸŒ§ Dense drizzle',
  61:'ğŸŒ§ Light rain',63:'ğŸŒ§ Rain',65:'ğŸŒ§ Heavy rain',
  71:'ğŸŒ¨ Light snow',73:'ğŸŒ¨ Snow',75:'â„ï¸ Heavy snow',
  80:'ğŸŒ¦ Light showers',81:'ğŸŒ§ Showers',82:'â›ˆ Heavy showers',
  95:'â›ˆ Thunderstorm',96:'â›ˆ Hail',99:'â›ˆ Hail storm',
};
const wmo  = c => WMO[c] ?? 'ğŸŒ¡ Unknown';
const ico  = c => wmo(c).split(' ')[0];
const desc = c => wmo(c).split(' ').slice(1).join(' ');

function dayMins(sr, ss) { return Math.round((new Date(ss) - new Date(sr)) / 60000); }
function dayFmt(sr, ss) { const m = dayMins(sr,ss); return `${Math.floor(m/60)}h ${m%60}m`; }
function timeFmt(iso) { return iso.split('T')[1]; }

let weatherData = {};
let activeDest = 'albir';

async function fetchAll() {
  const BASE = 'https://api.open-meteo.com/v1/forecast';
  const P = 'current=temperature_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,uv_index&daily=sunrise,sunset,temperature_2m_max,temperature_2m_min,precipitation_sum,uv_index_max&forecast_days=1';

  const osloP = fetch(`${BASE}?latitude=59.9139&longitude=10.7522&${P}&timezone=Europe/Oslo`).then(r=>r.json());
  const destPs = Object.entries(DESTS).map(([k,d]) =>
    fetch(`${BASE}?latitude=${d.lat}&longitude=${d.lon}&${P}&timezone=${d.tz}`).then(r=>r.json()).then(j => [k,j])
  );

  const [oslo, ...dests] = await Promise.all([osloP, ...destPs]);
  weatherData.oslo = oslo;
  for (const [k, data] of dests) weatherData[k] = data;
  document.getElementById('upd').textContent = 'Updated ' + new Date().toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});
}

function selectDest(key) {
  activeDest = key;
  document.querySelectorAll('.dest-btn').forEach(b => b.classList.toggle('active', b.dataset.key === key));
  renderComparison();
}

function renderComparison() {
  const o = weatherData.oslo;
  const s = weatherData[activeDest];
  const dest = DESTS[activeDest];
  if (!o || !s) return;

  const oC = o.current, oD = o.daily;
  const sC = s.current, sD = s.daily;

  const metrics = [
    { label:'ğŸŒ¡ Now',       oV: oC.temperature_2m,     sV: sC.temperature_2m,     fmt: v=>`${v.toFixed(1)}Â°C`, higher:true },
    { label:'ğŸ“ˆ Today high', oV: oD.temperature_2m_max[0], sV: sD.temperature_2m_max[0], fmt: v=>`${v.toFixed(1)}Â°C`, higher:true },
    { label:'ğŸŒ… Daylight',  oV: dayMins(oD.sunrise[0],oD.sunset[0]), sV: dayMins(sD.sunrise[0],sD.sunset[0]),
      oFmt: ()=>dayFmt(oD.sunrise[0],oD.sunset[0]), sFmt: ()=>dayFmt(sD.sunrise[0],sD.sunset[0]), higher:true },
    { label:'ğŸŒ‚ Rain today', oV: oD.precipitation_sum[0], sV: sD.precipitation_sum[0], fmt: v=>`${v.toFixed(1)} mm`, higher:false },
    { label:'ğŸ’¨ Wind',      oV: oC.wind_speed_10m,     sV: sC.wind_speed_10m,     fmt: v=>`${v.toFixed(1)} km/h`, higher:false },
    { label:'ğŸ”† UV max',    oV: oD.uv_index_max[0],    sV: sD.uv_index_max[0],    fmt: v=>`${v.toFixed(1)}`, higher:true },
  ];

  let spainWins = 0, osloWins = 0;
  const compRows = metrics.map(m => {
    const oFmt = m.oFmt ? m.oFmt() : m.fmt(m.oV);
    const sFmt = m.sFmt ? m.sFmt() : m.fmt(m.sV);
    const spainBetter = m.higher ? m.sV > m.oV : m.sV < m.oV;
    const tie = m.oV === m.sV;
    if (!tie) { if (spainBetter) spainWins++; else osloWins++; }
    return `
    <div class="comp-row">
      <div class="co ${!spainBetter&&!tie?'w':''}">${oFmt}${!spainBetter&&!tie?'<span class="wb wb-o">WIN</span>':''}</div>
      <div class="cl">${m.label}</div>
      <div class="cs ${spainBetter&&!tie?'w':''}">${spainBetter&&!tie?'<span class="wb wb-s">WIN</span>':''}${sFmt}</div>
    </div>`;
  }).join('');

  const total = spainWins + osloWins;
  const dots = metrics.map(m => {
    const sb = m.higher ? m.sV > m.oV : m.sV < m.oV;
    const tie = m.oV === m.sV;
    return `<div class="dot${tie?'':sb?' s':' o'}"></div>`;
  }).join('');

  const vEmoji = spainWins>=5?'ğŸŒ':spainWins===4?'ğŸŒ¤':spainWins===3?'âš–ï¸':spainWins===2?'ğŸ¥¶':'â„ï¸';
  const vTitle = spainWins>=5?`${dest.name} dominates.`:spainWins===4?`${dest.name} takes it.`:spainWins===3?'Too close to call.':spainWins===2?'Oslo edges it today.':'Stay in Norwayâ€¦ for now.';
  const vSub = `${dest.name} wins ${spainWins}/${metrics.length} today Â· Oslo wins ${osloWins}/${metrics.length}`;

  document.getElementById('content').innerHTML = `
  <div class="vs-grid">
    <div class="city-card oslo">
      <div class="city-flag">ğŸ‡³ğŸ‡´</div>
      <div class="city-name oslo">Oslo</div>
      <div class="city-sub">Norway Â· ${oD.sunrise[0].split('T')[0]}</div>
      <div class="big-temp">${oC.temperature_2m.toFixed(1)}Â°</div>
      <div class="feels">Feels like ${oC.apparent_temperature.toFixed(1)}Â°C</div>
      <div class="w-desc"><span class="w-emoji">${ico(oC.weather_code)}</span><span>${desc(oC.weather_code)}</span></div>
      <div class="stat-list">
        <div class="stat-row"><span class="stat-lbl">High / Low</span><span class="stat-val">${oD.temperature_2m_max[0].toFixed(1)}Â° / ${oD.temperature_2m_min[0].toFixed(1)}Â°</span></div>
        <div class="stat-row"><span class="stat-lbl">Daylight</span><span class="stat-val">${dayFmt(oD.sunrise[0],oD.sunset[0])}</span></div>
        <div class="stat-row"><span class="stat-lbl">Sunrise / Sunset</span><span class="stat-val">${timeFmt(oD.sunrise[0])} Â· ${timeFmt(oD.sunset[0])}</span></div>
        <div class="stat-row"><span class="stat-lbl">Wind</span><span class="stat-val">${oC.wind_speed_10m} km/h</span></div>
        <div class="stat-row"><span class="stat-lbl">UV index</span><span class="stat-val">${oD.uv_index_max[0].toFixed(1)}</span></div>
      </div>
    </div>

    <div class="vs-divider"><div class="vs-badge">VS</div></div>

    <div class="city-card spain">
      <div class="city-flag">${dest.flag}</div>
      <div class="city-name spain">${dest.name}</div>
      <div class="city-sub">${dest.sub}</div>
      <div class="big-temp">${sC.temperature_2m.toFixed(1)}Â°</div>
      <div class="feels">Feels like ${sC.apparent_temperature.toFixed(1)}Â°C</div>
      <div class="w-desc"><span class="w-emoji">${ico(sC.weather_code)}</span><span>${desc(sC.weather_code)}</span></div>
      <div class="stat-list">
        <div class="stat-row"><span class="stat-lbl">High / Low</span><span class="stat-val">${sD.temperature_2m_max[0].toFixed(1)}Â° / ${sD.temperature_2m_min[0].toFixed(1)}Â°</span></div>
        <div class="stat-row"><span class="stat-lbl">Daylight</span><span class="stat-val">${dayFmt(sD.sunrise[0],sD.sunset[0])}</span></div>
        <div class="stat-row"><span class="stat-lbl">Sunrise / Sunset</span><span class="stat-val">${timeFmt(sD.sunrise[0])} Â· ${timeFmt(sD.sunset[0])}</span></div>
        <div class="stat-row"><span class="stat-lbl">Wind</span><span class="stat-val">${sC.wind_speed_10m} km/h</span></div>
        <div class="stat-row"><span class="stat-lbl">UV index</span><span class="stat-val">${sD.uv_index_max[0].toFixed(1)}</span></div>
      </div>
    </div>
  </div>

  <div class="comparison">
    <div class="comp-head">ğŸ‡³ğŸ‡´ Oslo &nbsp;vs&nbsp; ${dest.flag} ${dest.name} â€” Head to head</div>
    ${compRows}
  </div>

  <div class="verdict">
    <div class="verdict-card">
      <div class="v-emoji">${vEmoji}</div>
      <div class="v-title">${vTitle}</div>
      <div class="v-sub">${vSub}</div>
      <div class="score-bar">${dots}</div>
      <div style="margin-top:.55rem;font-size:.7rem;color:var(--muted)">ğŸ‡³ğŸ‡´ Oslo &nbsp;Â·&nbsp; âšª Tie &nbsp;Â·&nbsp; ${dest.flag} ${dest.name}</div>
    </div>
  </div>`;
}

function countdown() {
  const d = MOVE_DATE - new Date();
  if (d <= 0) { document.getElementById('cd-d').textContent='ğŸ‰'; return; }
  document.getElementById('cd-d').textContent = Math.floor(d/86400000);
  document.getElementById('cd-h').textContent = Math.floor((d%86400000)/3600000);
  document.getElementById('cd-m').textContent = Math.floor((d%3600000)/60000);
}

async function refresh() {
  await fetchAll();
  renderComparison();
}

countdown();
setInterval(countdown, 30000);
refresh();
setInterval(refresh, 15 * 60 * 1000);
</script>
</body>
</html>
