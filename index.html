<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Oslo vs Spain â€” Is the Move Worth It?</title>
  <meta name="description" content="Daily weather comparison: Oslo vs Albir, MÃ¡laga, Gran Canaria and Barcelona.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœˆï¸</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Urbanist:wght@600;700;800&family=Inter:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg:     #111318;
      --bg2:    #1a1d25;
      --bg3:    #20242e;
      --border: rgba(255,255,255,0.07);
      --text:   #f0f2f5;
      --muted:  #8090a8;
      --cyan:   #0cb6eb;
      --green:  #22c55e;
      --amber:  #f59e0b;
      --red:    #f05050;
    }
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg); color: var(--text);
      min-height: 100vh; -webkit-font-smoothing: antialiased;
    }

    /* â”€â”€ HEADER â”€â”€ */
    .header {
      position: sticky; top: 0; z-index: 100;
      background: rgba(17,19,24,0.92);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      padding: .75rem 1.25rem;
      display: flex; align-items: center; justify-content: space-between; gap: 1rem; flex-wrap: wrap;
    }
    .logo { display: flex; align-items: center; gap: .6rem; }
    .logo-icon { font-size: 1.5rem; line-height: 1; }
    .logo h1 {
      font-family: 'Urbanist', sans-serif; font-size: 1.1rem;
      font-weight: 800; letter-spacing: -.03em; color: #fff; line-height: 1;
    }
    .logo h1 span { color: var(--amber); }
    .logo p { font-size: .7rem; color: var(--muted); margin-top: .15rem; }
    .live-badge {
      display: flex; align-items: center; gap: .35rem;
      font-size: .72rem; font-weight: 500; color: var(--green);
      background: rgba(34,197,94,.08); border: 1px solid rgba(34,197,94,.2);
      padding: .28rem .65rem; border-radius: 999px; white-space: nowrap;
    }
    .dot { width: 6px; height: 6px; border-radius: 50%; background: var(--green); animation: pulse 2s infinite; }
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.4} }

    /* â”€â”€ MAIN â”€â”€ */
    .main { max-width: 960px; margin: 0 auto; padding: 1.5rem 1.25rem 3rem; }

    /* â”€â”€ PICKER â”€â”€ */
    .picker {
      display: grid; grid-template-columns: 1fr auto 1fr;
      gap: .75rem; align-items: center;
      margin-bottom: 1.25rem;
    }
    @media (max-width: 560px) { .picker { grid-template-columns: 1fr 1fr; } .picker-vs { display: none; } }
    .picker-vs { text-align: center; font-size: .75rem; font-weight: 800; color: var(--muted); }

    .city-select {
      appearance: none;
      background: var(--bg2);
      border: 1px solid var(--border);
      color: var(--text);
      padding: .65rem 2.2rem .65rem .9rem;
      border-radius: 10px;
      font-size: .9rem; font-weight: 600;
      font-family: 'Inter', sans-serif;
      cursor: pointer; width: 100%;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%238090a8' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat; background-position: right .75rem center;
      transition: border-color .15s;
    }
    .city-select:focus { outline: none; border-color: var(--cyan); }
    #sel-right:focus   { border-color: var(--amber); }
    .city-select option { background: #20242e; }

    /* â”€â”€ VS GRID â”€â”€ */
    .vs-grid {
      display: grid; grid-template-columns: 1fr auto 1fr;
      gap: 0; margin-bottom: 1.25rem;
    }
    @media (max-width: 560px) { .vs-grid { grid-template-columns: 1fr; } .vs-divider { display: none; } }

    .city-card { background: var(--bg2); border: 1px solid var(--border); padding: 1.5rem; }
    .city-card.left  { border-radius: 14px 0 0 14px; border-right: none; }
    .city-card.right { border-radius: 0 14px 14px 0; border-left: none; }
    @media (max-width: 560px) {
      .city-card.left  { border-radius: 14px 14px 0 0; border-right: 1px solid var(--border); border-bottom: none; }
      .city-card.right { border-radius: 0 0 14px 14px; border-left: 1px solid var(--border); }
    }

    .city-flag { font-size: 1.8rem; line-height: 1; }
    .city-name {
      font-family: 'Urbanist', sans-serif;
      font-size: 1.4rem; font-weight: 800;
      letter-spacing: -.03em; margin: .35rem 0 .1rem; line-height: 1;
    }
    .city-name.left  { color: var(--cyan); }
    .city-name.right { color: var(--amber); }
    .city-sub { font-size: .75rem; color: var(--muted); }

    .big-temp {
      font-family: 'Urbanist', sans-serif;
      font-size: clamp(3.2rem, 10vw, 4.5rem);
      font-weight: 800; line-height: 1;
      margin: .9rem 0 .2rem; letter-spacing: -.04em;
    }
    .left  .big-temp { color: var(--cyan); }
    .right .big-temp { color: var(--amber); }

    .feels { font-size: .8rem; color: var(--muted); margin-bottom: .65rem; }
    .w-desc { font-size: .95rem; font-weight: 500; display: flex; align-items: center; gap: .4rem; }
    .w-ico { font-size: 1.3rem; }

    .stat-list { margin-top: 1rem; display: flex; flex-direction: column; }
    .stat-row {
      display: flex; justify-content: space-between; align-items: center;
      font-size: .8rem; padding: .32rem 0;
      border-bottom: 1px solid var(--border);
    }
    .stat-row:last-child { border-bottom: none; }
    .sl { color: var(--muted); }
    .sv { font-weight: 500; }

    .vs-divider {
      display: flex; align-items: center; justify-content: center;
      background: var(--bg2);
      border-top: 1px solid var(--border); border-bottom: 1px solid var(--border);
      width: 44px; align-self: stretch;
    }
    .vs-badge {
      background: var(--bg3); border: 2px solid var(--border); border-radius: 50%;
      width: 34px; height: 34px;
      display: flex; align-items: center; justify-content: center;
      font-size: .7rem; font-weight: 800; color: var(--muted);
      font-family: 'Urbanist', sans-serif;
    }

    /* â”€â”€ COMPARISON TABLE â”€â”€ */
    .section-title {
      font-family: 'Urbanist', sans-serif;
      font-size: .72rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: .1em;
      color: var(--muted); margin-bottom: .6rem;
    }
    .comp-row {
      display: grid; grid-template-columns: 1fr 2fr 1fr;
      align-items: center; gap: .5rem;
      padding: .55rem .75rem;
      background: var(--bg2); border: 1px solid var(--border);
      border-radius: 10px; margin-bottom: .3rem;
    }
    .co  { font-weight: 600; font-size: .88rem; }
    .cs  { font-weight: 600; font-size: .88rem; text-align: right; }
    .cl  { text-align: center; font-size: .72rem; color: var(--muted); }
    .co.w { color: var(--cyan); }
    .cs.w { color: var(--amber); }
    .win-tag {
      display: inline-block; font-size: .57rem; font-weight: 700;
      text-transform: uppercase; letter-spacing: .06em;
      padding: 2px 5px; border-radius: 4px; vertical-align: middle; margin: 0 3px;
    }
    .win-l { background: rgba(12,182,235,.12); color: var(--cyan); }
    .win-r { background: rgba(245,158,11,.12); color: var(--amber); }

    /* â”€â”€ VERDICT â”€â”€ */
    .verdict-card {
      background: var(--bg2); border: 1px solid var(--border);
      border-radius: 14px; padding: 1.5rem; text-align: center;
      margin-top: 1.25rem;
    }
    .v-emoji { font-size: 2.2rem; margin-bottom: .4rem; }
    .v-title {
      font-family: 'Urbanist', sans-serif;
      font-size: 1.25rem; font-weight: 800; letter-spacing: -.02em;
    }
    .v-sub { font-size: .82rem; color: var(--muted); margin-top: .35rem; }
    .score-bar { display: flex; justify-content: center; gap: .35rem; margin-top: .85rem; }
    .sdot { width: 11px; height: 11px; border-radius: 50%; background: var(--bg3); border: 2px solid var(--border); }
    .sdot.l { background: var(--cyan);  border-color: var(--cyan); }
    .sdot.r { background: var(--amber); border-color: var(--amber); }

    /* â”€â”€ FOOTER â”€â”€ */
    .footer {
      border-top: 1px solid var(--border);
      padding: 1.5rem 1.25rem; text-align: center;
      font-size: .72rem; color: var(--muted);
    }
    .footer a { color: var(--muted); text-decoration: none; }
    .footer a:hover { color: var(--text); }
  </style>
</head>
<body>

<header class="header">
  <div class="logo">
    <div class="logo-icon">âœˆï¸</div>
    <div>
      <h1>Oslo <span>vs</span> Spain</h1>
      <p>Daily weather comparison</p>
    </div>
  </div>
  <div class="live-badge"><div class="dot"></div><span id="upd">Live</span></div>
</header>

<div class="main">

  <!-- Pickers -->
  <div class="picker">
    <select class="city-select" id="sel-left" onchange="selectCity('left',this.value)">
      <option value="oslo">ğŸ‡³ğŸ‡´ Oslo</option>
      <option value="albir">ğŸ– Albir</option>
      <option value="malaga">â˜€ï¸ MÃ¡laga</option>
      <option value="canaria">ğŸŒ´ Gran Canaria</option>
      <option value="barcelona">ğŸ™ Barcelona</option>
    </select>
    <div class="picker-vs">VS</div>
    <select class="city-select" id="sel-right" onchange="selectCity('right',this.value)">
      <option value="oslo">ğŸ‡³ğŸ‡´ Oslo</option>
      <option value="albir" selected>ğŸ– Albir</option>
      <option value="malaga">â˜€ï¸ MÃ¡laga</option>
      <option value="canaria">ğŸŒ´ Gran Canaria</option>
      <option value="barcelona">ğŸ™ Barcelona</option>
    </select>
  </div>

  <!-- Cards + comparison -->
  <div id="content">
    <div style="text-align:center;padding:3rem;color:var(--muted);font-size:.9rem">Loading weatherâ€¦</div>
  </div>

</div>

<footer class="footer">
  Weather via <a href="https://open-meteo.com" target="_blank">Open-Meteo</a> Â·
  Refreshes every 15 min Â·
  <a href="https://github.com/PiE-Derby/oslo-vs-spain" target="_blank">source</a>
</footer>

<script>
const CITIES = {
  oslo:      { name:'Oslo',         sub:'Norway',               flag:'ğŸ‡³ğŸ‡´', lat:59.9139, lon:10.7522,   tz:'Europe/Oslo' },
  albir:     { name:'Albir',        sub:'Costa Blanca, Spain',  flag:'ğŸ‡ªğŸ‡¸', lat:38.5678, lon:-0.0628,   tz:'Europe/Madrid' },
  malaga:    { name:'MÃ¡laga',       sub:'Costa del Sol, Spain', flag:'ğŸ‡ªğŸ‡¸', lat:36.7213, lon:-4.4213,   tz:'Europe/Madrid' },
  canaria:   { name:'Gran Canaria', sub:'Canary Islands',       flag:'ğŸ‡®ğŸ‡¨', lat:27.9202, lon:-15.5474,  tz:'Atlantic/Canary' },
  barcelona: { name:'Barcelona',    sub:'Catalonia, Spain',     flag:'ğŸ‡ªğŸ‡¸', lat:41.3874, lon:2.1686,    tz:'Europe/Madrid' },
};

const WMO = {
  0:'â˜€ï¸ Clear sky',1:'ğŸŒ¤ Mainly clear',2:'â›… Partly cloudy',3:'â˜ï¸ Overcast',
  45:'ğŸŒ« Foggy',48:'ğŸŒ« Icy fog',51:'ğŸŒ¦ Light drizzle',53:'ğŸŒ¦ Drizzle',55:'ğŸŒ§ Dense drizzle',
  61:'ğŸŒ§ Light rain',63:'ğŸŒ§ Rain',65:'ğŸŒ§ Heavy rain',71:'ğŸŒ¨ Light snow',73:'ğŸŒ¨ Snow',
  75:'â„ï¸ Heavy snow',80:'ğŸŒ¦ Light showers',81:'ğŸŒ§ Showers',82:'â›ˆ Heavy showers',
  95:'â›ˆ Thunderstorm',96:'â›ˆ Hail',99:'â›ˆ Hail storm',
};
const ico  = c => (WMO[c]??'ğŸŒ¡ Unknown').split(' ')[0];
const desc = c => (WMO[c]??'Unknown').split(' ').slice(1).join(' ');
const dayMins = (sr,ss) => Math.round((new Date(ss)-new Date(sr))/60000);
const dayFmt  = (sr,ss) => { const m=dayMins(sr,ss); return `${Math.floor(m/60)}h ${m%60}m`; };
const timeFmt = iso => iso.split('T')[1];

let weather = {};
let leftKey = 'oslo', rightKey = 'albir';

async function fetchAll() {
  const BASE = 'https://api.open-meteo.com/v1/forecast';
  const P = 'current=temperature_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,uv_index&daily=sunrise,sunset,temperature_2m_max,temperature_2m_min,precipitation_sum,uv_index_max&forecast_days=1';
  await Promise.all(Object.entries(CITIES).map(async ([k,c]) => {
    const r = await fetch(`${BASE}?latitude=${c.lat}&longitude=${c.lon}&${P}&timezone=${c.tz}`);
    weather[k] = await r.json();
  }));
  const t = new Date().toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});
  document.getElementById('upd').textContent = `Updated ${t}`;
}

function selectCity(side, key) {
  if (side==='left') leftKey=key; else rightKey=key;
  render();
}

function cityCard(key, side) {
  const c = CITIES[key], d = weather[key];
  if (!d) return '';
  const cur = d.current, day = d.daily;
  return `
  <div class="city-card ${side}">
    <div class="city-flag">${c.flag}</div>
    <div class="city-name ${side}">${c.name}</div>
    <div class="city-sub">${c.sub}</div>
    <div class="big-temp">${cur.temperature_2m.toFixed(1)}Â°</div>
    <div class="feels">Feels like ${cur.apparent_temperature.toFixed(1)}Â°C</div>
    <div class="w-desc"><span class="w-ico">${ico(cur.weather_code)}</span><span>${desc(cur.weather_code)}</span></div>
    <div class="stat-list">
      <div class="stat-row"><span class="sl">High / Low</span><span class="sv">${day.temperature_2m_max[0].toFixed(1)}Â° / ${day.temperature_2m_min[0].toFixed(1)}Â°</span></div>
      <div class="stat-row"><span class="sl">Daylight</span><span class="sv">${dayFmt(day.sunrise[0],day.sunset[0])}</span></div>
      <div class="stat-row"><span class="sl">Sunrise / Sunset</span><span class="sv">${timeFmt(day.sunrise[0])} Â· ${timeFmt(day.sunset[0])}</span></div>
      <div class="stat-row"><span class="sl">Wind</span><span class="sv">${cur.wind_speed_10m} km/h</span></div>
      <div class="stat-row"><span class="sl">Rain today</span><span class="sv">${day.precipitation_sum[0].toFixed(1)} mm</span></div>
      <div class="stat-row"><span class="sl">UV index</span><span class="sv">${day.uv_index_max[0].toFixed(1)}</span></div>
    </div>
  </div>`;
}

function render() {
  const L=weather[leftKey], R=weather[rightKey];
  const lc=CITIES[leftKey], rc=CITIES[rightKey];
  if (!L||!R) return;
  const lC=L.current, lD=L.daily, rC=R.current, rD=R.daily;

  const metrics = [
    { label:'ğŸŒ¡ Now',         lV:lC.temperature_2m,        rV:rC.temperature_2m,        fmt:v=>`${v.toFixed(1)}Â°C`, higher:true },
    { label:'ğŸ“ˆ Today high',  lV:lD.temperature_2m_max[0], rV:rD.temperature_2m_max[0], fmt:v=>`${v.toFixed(1)}Â°C`, higher:true },
    { label:'ğŸ“‰ Today low',   lV:lD.temperature_2m_min[0], rV:rD.temperature_2m_min[0], fmt:v=>`${v.toFixed(1)}Â°C`, higher:true },
    { label:'ğŸŒ… Daylight',    lV:dayMins(lD.sunrise[0],lD.sunset[0]), rV:dayMins(rD.sunrise[0],rD.sunset[0]),
      lFmt:()=>dayFmt(lD.sunrise[0],lD.sunset[0]), rFmt:()=>dayFmt(rD.sunrise[0],rD.sunset[0]), higher:true },
    { label:'ğŸŒ‚ Rain today',  lV:lD.precipitation_sum[0],  rV:rD.precipitation_sum[0],  fmt:v=>`${v.toFixed(1)} mm`, higher:false },
    { label:'ğŸ’¨ Wind',        lV:lC.wind_speed_10m,        rV:rC.wind_speed_10m,        fmt:v=>`${v.toFixed(1)} km/h`, higher:false },
    { label:'ğŸ”† UV max',      lV:lD.uv_index_max[0],       rV:rD.uv_index_max[0],       fmt:v=>`${v.toFixed(1)}`, higher:true },
  ];

  let lW=0, rW=0;
  const rows = metrics.map(m => {
    const lf = m.lFmt?m.lFmt():m.fmt(m.lV);
    const rf = m.rFmt?m.rFmt():m.fmt(m.rV);
    const rBetter = m.higher ? m.rV>m.lV : m.rV<m.lV;
    const tie = m.lV===m.rV;
    if (!tie) { rBetter?rW++:lW++; }
    return `
    <div class="comp-row">
      <div class="co ${!rBetter&&!tie?'w':''}">${lf}${!rBetter&&!tie?'<span class="win-tag win-l">WIN</span>':''}</div>
      <div class="cl">${m.label}</div>
      <div class="cs ${rBetter&&!tie?'w':''}">${rBetter&&!tie?'<span class="win-tag win-r">WIN</span>':''}${rf}</div>
    </div>`;
  }).join('');

  const dots = metrics.map(m=>{
    const rb=m.higher?m.rV>m.lV:m.rV<m.lV, tie=m.lV===m.rV;
    return `<div class="sdot${tie?'':rb?' r':' l'}"></div>`;
  }).join('');

  const winner = rW>lW?rc:lW>rW?lc:null;
  const vEmoji = !winner?'âš–ï¸':winner===rc?(rW>=6?'ğŸŒ':rW>=5?'ğŸŒ¤':'ğŸŒ¥'):'ğŸ¥¶';
  const vTitle = !winner?'Dead heat today.':winner===rc?`${rc.name} wins today.`:`${lc.name} holds its ground.`;
  const vSub   = `${lc.flag} ${lc.name} ${lW} â€” ${rW} ${rc.name} ${rc.flag}`;

  document.getElementById('content').innerHTML = `
  <div class="vs-grid">
    ${cityCard(leftKey,'left')}
    <div class="vs-divider"><div class="vs-badge">VS</div></div>
    ${cityCard(rightKey,'right')}
  </div>
  <div class="section-title">Head to head â€” ${lc.flag} ${lc.name} vs ${rc.flag} ${rc.name}</div>
  ${rows}
  <div class="verdict-card">
    <div class="v-emoji">${vEmoji}</div>
    <div class="v-title">${vTitle}</div>
    <div class="v-sub">${vSub}</div>
    <div class="score-bar">${dots}</div>
    <div style="margin-top:.5rem;font-size:.68rem;color:var(--muted)">${lc.flag} ${lc.name} &nbsp;Â·&nbsp; âšª Tie &nbsp;Â·&nbsp; ${rc.flag} ${rc.name}</div>
  </div>`;
}

async function refresh() { await fetchAll(); render(); }

refresh(); setInterval(refresh,15*60*1000);
</script>
</body>
</html>
