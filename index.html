<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Oslo vs Spain â€” Is the Move Worth It?</title>
  <meta name="description" content="Daily weather battle: Oslo vs Albir, MÃ¡laga and Gran Canaria. Compare any two locations.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âœˆï¸</text></svg>">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:     #0e1117;
      --bg2:    #161b24;
      --bg3:    #1e2535;
      --border: rgba(255,255,255,0.07);
      --text:   #f0f2f5;
      --muted:  #7a8ba0;
      --left:   #4da6ff;
      --right:  #ff7c3e;
      --green:  #22c55e;
      --gold:   #fbbf24;
      --red:    #ef4444;
    }

    body {
      font-family: -apple-system, 'Segoe UI', sans-serif;
      background: var(--bg); color: var(--text);
      min-height: 100vh; -webkit-font-smoothing: antialiased;
    }

    header {
      text-align: center;
      padding: 2.5rem 1rem 1.5rem;
      border-bottom: 1px solid var(--border);
    }
    .flags { font-size: clamp(1.8rem,5vw,2.6rem); display:block; margin-bottom:.4rem; }
    header h1 { font-size: clamp(1.6rem,5vw,2.4rem); font-weight:800; letter-spacing:-.03em; }
    header p  { color: var(--muted); font-size:.88rem; margin-top:.4rem; }

    .countdown {
      display: inline-flex; gap:1rem; margin-top:1.2rem;
      background: var(--bg2); border:1px solid var(--border);
      border-radius:12px; padding:.75rem 1.5rem;
      flex-wrap:wrap; justify-content:center; align-items:center;
    }
    .cd-unit { text-align:center; }
    .cd-num  { font-size:1.6rem; font-weight:800; color:var(--right); line-height:1; }
    .cd-lbl  { font-size:.62rem; color:var(--muted); text-transform:uppercase; letter-spacing:.08em; margin-top:2px; }
    .cd-sep  { color:var(--border); font-size:1.4rem; }

    /* â”€â”€ DROPDOWNS â”€â”€ */
    .picker {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      max-width: 900px;
      margin: 1.5rem auto 0;
      padding: 0 1rem;
      gap: .5rem;
      align-items: center;
    }
    @media (max-width:600px) {
      .picker { grid-template-columns: 1fr 1fr; }
      .picker-vs { display:none; }
    }
    .picker-vs {
      text-align:center; font-size:.75rem; font-weight:800;
      color:var(--muted); padding:0 .5rem;
    }
    .city-select {
      appearance: none;
      background: var(--bg2);
      border: 1px solid var(--border);
      color: var(--text);
      padding: .65rem 2.2rem .65rem .9rem;
      border-radius: 10px;
      font-size: .92rem;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      width: 100%;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%237a8ba0' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right .75rem center;
    }
    .city-select:focus { outline:2px solid var(--left); border-color:var(--left); }
    #sel-right:focus   { outline-color:var(--right); border-color:var(--right); }
    .city-select option { background: #1e2535; }

    /* â”€â”€ VS GRID â”€â”€ */
    .vs-grid {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      max-width: 900px;
      margin: 1.25rem auto 0;
      padding: 0 1rem;
      align-items: start;
    }
    @media (max-width:600px) {
      .vs-grid { grid-template-columns:1fr; }
      .vs-divider { display:none; }
    }

    .city-card { background:var(--bg2); border:1px solid var(--border); padding:1.5rem; }
    .city-card.left  { border-radius:16px 0 0 16px; border-right:none; }
    .city-card.right { border-radius:0 16px 16px 0; border-left:none; }
    @media (max-width:600px) {
      .city-card.left  { border-radius:16px 16px 0 0; border-right:1px solid var(--border); border-bottom:none; }
      .city-card.right { border-radius:0 0 16px 16px; border-left:1px solid var(--border); }
    }

    .city-flag { font-size:2rem; }
    .city-name { font-size:1.3rem; font-weight:800; margin:.3rem 0 .1rem; letter-spacing:-.02em; }
    .city-name.left  { color:var(--left); }
    .city-name.right { color:var(--right); }
    .city-sub  { font-size:.78rem; color:var(--muted); }

    .big-temp {
      font-size: clamp(3.5rem,10vw,5rem);
      font-weight:900; line-height:1;
      margin:1rem 0 .2rem; letter-spacing:-.04em;
    }
    .left  .big-temp { color:var(--left); }
    .right .big-temp { color:var(--right); }

    .feels  { font-size:.82rem; color:var(--muted); margin-bottom:.7rem; }
    .w-desc { font-size:1rem; font-weight:600; display:flex; align-items:center; gap:.4rem; }
    .w-ico  { font-size:1.4rem; }

    .stat-list { margin-top:1rem; display:flex; flex-direction:column; gap:.35rem; }
    .stat-row  {
      display:flex; justify-content:space-between; align-items:center;
      font-size:.82rem; padding:.28rem 0;
      border-bottom:1px solid var(--border);
    }
    .stat-row:last-child { border-bottom:none; }
    .sl { color:var(--muted); }
    .sv { font-weight:600; }

    .vs-divider {
      display:flex; align-items:center; justify-content:center;
      background:var(--bg2);
      border-top:1px solid var(--border); border-bottom:1px solid var(--border);
      width:48px; align-self:stretch;
    }
    .vs-badge {
      background:var(--bg3); border:2px solid var(--border); border-radius:50%;
      width:36px; height:36px;
      display:flex; align-items:center; justify-content:center;
      font-size:.72rem; font-weight:800; color:var(--muted);
    }

    .comparison { max-width:900px; margin:1.25rem auto 0; padding:0 1rem; }
    .comp-head  { font-size:.72rem; text-transform:uppercase; letter-spacing:.1em; color:var(--muted); margin-bottom:.6rem; }
    .comp-row {
      display:grid; grid-template-columns:1fr 2fr 1fr;
      align-items:center; gap:.5rem;
      padding:.6rem .75rem;
      background:var(--bg2); border:1px solid var(--border);
      border-radius:10px; margin-bottom:.35rem;
    }
    .co  { font-weight:700; font-size:.92rem; }
    .cs  { font-weight:700; font-size:.92rem; text-align:right; }
    .cl  { text-align:center; font-size:.73rem; color:var(--muted); }
    .co.w { color:var(--left); }
    .cs.w { color:var(--right); }
    .wb {
      display:inline-block; font-size:.58rem; font-weight:800;
      text-transform:uppercase; letter-spacing:.06em;
      padding:2px 5px; border-radius:4px; vertical-align:middle; margin:0 3px;
    }
    .wb-l { background:rgba(77,166,255,.15); color:var(--left); }
    .wb-r { background:rgba(255,124,62,.15);  color:var(--right); }

    .verdict { max-width:900px; margin:1.25rem auto 2rem; padding:0 1rem; }
    .verdict-card {
      background:var(--bg2); border:1px solid var(--border);
      border-radius:16px; padding:1.5rem; text-align:center;
    }
    .v-emoji { font-size:2.2rem; margin-bottom:.4rem; }
    .v-title { font-size:1.2rem; font-weight:800; letter-spacing:-.02em; }
    .v-sub   { font-size:.83rem; color:var(--muted); margin-top:.35rem; }
    .score-bar { display:flex; justify-content:center; gap:.35rem; margin-top:.85rem; }
    .dot { width:12px; height:12px; border-radius:50%; background:var(--bg3); border:2px solid var(--border); }
    .dot.l { background:var(--left);  border-color:var(--left); }
    .dot.r { background:var(--right); border-color:var(--right); }

    footer {
      text-align:center; padding:1.5rem 1rem 2.5rem;
      font-size:.73rem; color:var(--muted);
      border-top:1px solid var(--border);
    }
    footer a { color:var(--muted); }
  </style>
</head>
<body>

<header>
  <span class="flags">ğŸ‡³ğŸ‡´ âœˆï¸ ğŸ‡ªğŸ‡¸</span>
  <h1>Oslo vs Spain</h1>
  <p>Is the move worth it? Let the weather decide.</p>
  <div class="countdown">
    <div class="cd-unit"><div class="cd-num" id="cd-d">â€¦</div><div class="cd-lbl">days</div></div>
    <span class="cd-sep">:</span>
    <div class="cd-unit"><div class="cd-num" id="cd-h">â€¦</div><div class="cd-lbl">hours</div></div>
    <span class="cd-sep">:</span>
    <div class="cd-unit"><div class="cd-num" id="cd-m">â€¦</div><div class="cd-lbl">min</div></div>
    <div style="border-left:1px solid var(--border);padding-left:1rem">
      <span style="font-size:.82rem;color:var(--muted);font-weight:600">until the move âœˆï¸</span>
    </div>
  </div>
</header>

<div class="picker">
  <select class="city-select" id="sel-left" onchange="selectCity('left',this.value)">
    <option value="oslo">ğŸ‡³ğŸ‡´ Oslo</option>
    <option value="albir">ğŸ– Albir</option>
    <option value="malaga">â˜€ï¸ MÃ¡laga</option>
    <option value="canaria">ğŸŒ´ Gran Canaria</option>
    <option value="barcelona">ğŸ™ Barcelona</option>
  </select>
  <div class="picker-vs">VS</div>
  <select class="city-select" id="sel-right" onchange="selectCity('right',this.value)">
    <option value="oslo">ğŸ‡³ğŸ‡´ Oslo</option>
    <option value="albir" selected>ğŸ– Albir</option>
    <option value="malaga">â˜€ï¸ MÃ¡laga</option>
    <option value="canaria">ğŸŒ´ Gran Canaria</option>
    <option value="barcelona">ğŸ™ Barcelona</option>
  </select>
</div>

<div id="content" style="padding-bottom:2rem">
  <div style="text-align:center;padding:3rem;color:var(--muted)">ğŸŒ Loading weatherâ€¦</div>
</div>

<footer>
  Weather via <a href="https://open-meteo.com" target="_blank">Open-Meteo</a> Â·
  Auto-refreshes every 15 min Â·
  <a href="https://github.com/PiE-Derby/oslo-vs-spain" target="_blank">source</a> Â·
  <span id="upd"></span>
</footer>

<script>
const MOVE_DATE = new Date('2026-08-01T08:00:00+02:00');

const CITIES = {
  oslo:    { name:'Oslo',        sub:'Norway',              flag:'ğŸ‡³ğŸ‡´', lat:59.9139, lon:10.7522,  tz:'Europe/Oslo' },
  albir:   { name:'Albir',       sub:'Costa Blanca, Spain', flag:'ğŸ‡ªğŸ‡¸', lat:38.5678, lon:-0.0628,  tz:'Europe/Madrid' },
  malaga:  { name:'MÃ¡laga',      sub:'Costa del Sol, Spain',flag:'ğŸ‡ªğŸ‡¸', lat:36.7213, lon:-4.4213,  tz:'Europe/Madrid' },
  canaria:   { name:'Gran Canaria',sub:'Canary Islands',      flag:'ğŸ‡®ğŸ‡¨', lat:27.9202, lon:-15.5474, tz:'Atlantic/Canary' },
  barcelona: { name:'Barcelona',  sub:'Catalonia, Spain',     flag:'ğŸ‡ªğŸ‡¸', lat:41.3874, lon:2.1686,   tz:'Europe/Madrid' },
};

const WMO = {
  0:'â˜€ï¸ Clear sky',1:'ğŸŒ¤ Mainly clear',2:'â›… Partly cloudy',3:'â˜ï¸ Overcast',
  45:'ğŸŒ« Foggy',48:'ğŸŒ« Icy fog',51:'ğŸŒ¦ Light drizzle',53:'ğŸŒ¦ Drizzle',55:'ğŸŒ§ Dense drizzle',
  61:'ğŸŒ§ Light rain',63:'ğŸŒ§ Rain',65:'ğŸŒ§ Heavy rain',71:'ğŸŒ¨ Light snow',73:'ğŸŒ¨ Snow',
  75:'â„ï¸ Heavy snow',80:'ğŸŒ¦ Light showers',81:'ğŸŒ§ Showers',82:'â›ˆ Heavy showers',
  95:'â›ˆ Thunderstorm',96:'â›ˆ Hail',99:'â›ˆ Hail storm',
};
const wmo  = c => WMO[c] ?? 'ğŸŒ¡ Unknown';
const ico  = c => wmo(c).split(' ')[0];
const desc = c => wmo(c).split(' ').slice(1).join(' ');
const dayMins = (sr,ss) => Math.round((new Date(ss)-new Date(sr))/60000);
const dayFmt  = (sr,ss) => { const m=dayMins(sr,ss); return `${Math.floor(m/60)}h ${m%60}m`; };
const timeFmt = iso => iso.split('T')[1];

let weather = {};
let leftKey  = 'oslo';
let rightKey = 'albir';

async function fetchAll() {
  const BASE = 'https://api.open-meteo.com/v1/forecast';
  const P = 'current=temperature_2m,apparent_temperature,precipitation,weather_code,wind_speed_10m,uv_index&daily=sunrise,sunset,temperature_2m_max,temperature_2m_min,precipitation_sum,uv_index_max&forecast_days=1';
  await Promise.all(Object.entries(CITIES).map(async ([k,c]) => {
    const r = await fetch(`${BASE}?latitude=${c.lat}&longitude=${c.lon}&${P}&timezone=${c.tz}`);
    weather[k] = await r.json();
  }));
  document.getElementById('upd').textContent = 'Updated ' + new Date().toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});
}

function selectCity(side, key) {
  if (side === 'left')  leftKey  = key;
  else                  rightKey = key;
  render();
}

function cityCard(key, side) {
  const c = CITIES[key];
  const d = weather[key];
  if (!d) return '';
  const cur = d.current, day = d.daily;
  return `
  <div class="city-card ${side}">
    <div class="city-flag">${c.flag}</div>
    <div class="city-name ${side}">${c.name}</div>
    <div class="city-sub">${c.sub}</div>
    <div class="big-temp">${cur.temperature_2m.toFixed(1)}Â°</div>
    <div class="feels">Feels like ${cur.apparent_temperature.toFixed(1)}Â°C</div>
    <div class="w-desc"><span class="w-ico">${ico(cur.weather_code)}</span><span>${desc(cur.weather_code)}</span></div>
    <div class="stat-list">
      <div class="stat-row"><span class="sl">High / Low</span><span class="sv">${day.temperature_2m_max[0].toFixed(1)}Â° / ${day.temperature_2m_min[0].toFixed(1)}Â°</span></div>
      <div class="stat-row"><span class="sl">Daylight</span><span class="sv">${dayFmt(day.sunrise[0],day.sunset[0])}</span></div>
      <div class="stat-row"><span class="sl">Sunrise / Sunset</span><span class="sv">${timeFmt(day.sunrise[0])} Â· ${timeFmt(day.sunset[0])}</span></div>
      <div class="stat-row"><span class="sl">Wind</span><span class="sv">${cur.wind_speed_10m} km/h</span></div>
      <div class="stat-row"><span class="sl">Rain today</span><span class="sv">${day.precipitation_sum[0].toFixed(1)} mm</span></div>
      <div class="stat-row"><span class="sl">UV index</span><span class="sv">${day.uv_index_max[0].toFixed(1)}</span></div>
    </div>
  </div>`;
}

function render() {
  const L = weather[leftKey],  lc = CITIES[leftKey];
  const R = weather[rightKey], rc = CITIES[rightKey];
  if (!L || !R) return;

  const lCur = L.current, lDay = L.daily;
  const rCur = R.current, rDay = R.daily;

  const metrics = [
    { label:'ğŸŒ¡ Now',        lV:lCur.temperature_2m,       rV:rCur.temperature_2m,       fmt:v=>`${v.toFixed(1)}Â°C`, higher:true },
    { label:'ğŸ“ˆ Today high', lV:lDay.temperature_2m_max[0], rV:rDay.temperature_2m_max[0], fmt:v=>`${v.toFixed(1)}Â°C`, higher:true },
    { label:'ğŸ“‰ Today low',  lV:lDay.temperature_2m_min[0], rV:rDay.temperature_2m_min[0], fmt:v=>`${v.toFixed(1)}Â°C`, higher:true },
    { label:'ğŸŒ… Daylight',   lV:dayMins(lDay.sunrise[0],lDay.sunset[0]), rV:dayMins(rDay.sunrise[0],rDay.sunset[0]),
      lFmt:()=>dayFmt(lDay.sunrise[0],lDay.sunset[0]), rFmt:()=>dayFmt(rDay.sunrise[0],rDay.sunset[0]), higher:true },
    { label:'ğŸŒ‚ Rain today', lV:lDay.precipitation_sum[0],  rV:rDay.precipitation_sum[0],  fmt:v=>`${v.toFixed(1)} mm`, higher:false },
    { label:'ğŸ’¨ Wind',       lV:lCur.wind_speed_10m,        rV:rCur.wind_speed_10m,        fmt:v=>`${v.toFixed(1)} km/h`, higher:false },
    { label:'ğŸ”† UV max',     lV:lDay.uv_index_max[0],       rV:rDay.uv_index_max[0],       fmt:v=>`${v.toFixed(1)}`, higher:true },
  ];

  let lWins = 0, rWins = 0;
  const rows = metrics.map(m => {
    const lFmt = m.lFmt ? m.lFmt() : m.fmt(m.lV);
    const rFmt = m.rFmt ? m.rFmt() : m.fmt(m.rV);
    const rBetter = m.higher ? m.rV > m.lV : m.rV < m.lV;
    const tie = m.lV === m.rV;
    if (!tie) { if (rBetter) rWins++; else lWins++; }
    return `
    <div class="comp-row">
      <div class="co ${!rBetter&&!tie?'w':''}">${lFmt}${!rBetter&&!tie?'<span class="wb wb-l">WIN</span>':''}</div>
      <div class="cl">${m.label}</div>
      <div class="cs ${rBetter&&!tie?'w':''}">${rBetter&&!tie?'<span class="wb wb-r">WIN</span>':''}${rFmt}</div>
    </div>`;
  }).join('');

  const dots = metrics.map(m => {
    const rb = m.higher ? m.rV > m.lV : m.rV < m.lV;
    const tie = m.lV === m.rV;
    return `<div class="dot${tie?'':rb?' r':' l'}"></div>`;
  }).join('');

  const total = metrics.length;
  const winner = rWins > lWins ? rc : lWins > rWins ? lc : null;
  const vEmoji = !winner ? 'âš–ï¸' : winner === rc ? (rWins>=6?'ğŸŒ':rWins>=5?'ğŸŒ¤':'ğŸŒ¥') : 'ğŸ¥¶';
  const vTitle = !winner ? 'Dead heat today.' :
    winner === rc ? `${rc.name} wins today.` : `${lc.name} holds its ground.`;
  const vSub = `${lc.name} ${lWins} â€” ${rWins} ${rc.name}`;

  document.getElementById('content').innerHTML = `
  <div class="vs-grid">
    ${cityCard(leftKey,'left')}
    <div class="vs-divider"><div class="vs-badge">VS</div></div>
    ${cityCard(rightKey,'right')}
  </div>
  <div class="comparison">
    <div class="comp-head">${lc.flag} ${lc.name} &nbsp;vs&nbsp; ${rc.flag} ${rc.name}</div>
    ${rows}
  </div>
  <div class="verdict">
    <div class="verdict-card">
      <div class="v-emoji">${vEmoji}</div>
      <div class="v-title">${vTitle}</div>
      <div class="v-sub">${vSub}</div>
      <div class="score-bar">${dots}</div>
      <div style="margin-top:.55rem;font-size:.7rem;color:var(--muted)">
        ${lc.flag} ${lc.name} &nbsp;Â·&nbsp; âšª Tie &nbsp;Â·&nbsp; ${rc.flag} ${rc.name}
      </div>
    </div>
  </div>`;
}

function countdown() {
  const d = MOVE_DATE - new Date();
  if (d <= 0) { document.getElementById('cd-d').textContent = 'ğŸ‰'; return; }
  document.getElementById('cd-d').textContent = Math.floor(d/86400000);
  document.getElementById('cd-h').textContent = Math.floor((d%86400000)/3600000);
  document.getElementById('cd-m').textContent = Math.floor((d%3600000)/60000);
}

async function refresh() {
  await fetchAll();
  render();
}

countdown();
setInterval(countdown, 30000);
refresh();
setInterval(refresh, 15 * 60 * 1000);
</script>
</body>
</html>
